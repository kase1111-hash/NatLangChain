# NatLangChain Environment Configuration
# Copy this file to .env and configure as needed

# =============================================================================
# LLM Configuration (Required for advanced features)
# =============================================================================
# Anthropic API key for semantic validation, contract parsing, oracles, etc.
# Get your key at: https://console.anthropic.com/
ANTHROPIC_API_KEY=your_api_key_here

# =============================================================================
# Server Configuration
# =============================================================================
# Host address to bind to (0.0.0.0 for all interfaces)
HOST=0.0.0.0

# Port number for the API server
PORT=5000

# Enable Flask debug mode (set to "true" for development)
FLASK_DEBUG=false

# =============================================================================
# Storage Backend
# =============================================================================
# Storage backend type: json (default), postgresql, memory
STORAGE_BACKEND=json

# File path for JSON storage (when STORAGE_BACKEND=json)
CHAIN_DATA_FILE=chain_data.json

# PostgreSQL connection (when STORAGE_BACKEND=postgresql)
# DATABASE_URL=postgresql://user:password@localhost:5432/natlangchain

# =============================================================================
# Data Encryption (Recommended for Production)
# =============================================================================
# Encryption key for protecting blockchain data at rest
# Generate a secure key using: python -c "from src.encryption import generate_encryption_key; print(generate_encryption_key())"
# IMPORTANT: Store this key securely and back it up - data cannot be recovered without it!
NATLANGCHAIN_ENCRYPTION_KEY=

# Enable/disable encryption (default: true if key is set)
# Set to "false" to disable encryption even when a key is configured
NATLANGCHAIN_ENCRYPTION_ENABLED=true

# =============================================================================
# Authentication (Recommended for Production)
# =============================================================================
# API key for client authentication
# Generate a secure key: python -c "import secrets; print(secrets.token_urlsafe(32))"
NATLANGCHAIN_API_KEY=

# Require API key authentication for mutation endpoints
# SECURITY: Defaults to "true" in production - set to "false" only for development
NATLANGCHAIN_REQUIRE_AUTH=true

# =============================================================================
# Rate Limiting
# =============================================================================
# Maximum requests allowed per window
RATE_LIMIT_REQUESTS=100

# Rate limit window duration in seconds
RATE_LIMIT_WINDOW=60

# =============================================================================
# CORS Configuration
# =============================================================================
# Allowed origins for CORS (comma-separated list of specific origins)
# SECURITY: Do NOT use "*" in production - specify exact origins
# Example: "https://myapp.com,https://admin.myapp.com"
# Leave empty for same-origin only (most secure)
CORS_ALLOWED_ORIGINS=

# =============================================================================
# Distributed Infrastructure (Production)
# =============================================================================
# Redis connection for distributed locking, caching, and coordination
# Required for multi-instance deployments
# REDIS_URL=redis://localhost:6379/0

# =============================================================================
# Logging & Monitoring
# =============================================================================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log format: json (structured, for production) or console (human-readable)
LOG_FORMAT=console

# =============================================================================
# Production Server
# =============================================================================
# Number of gunicorn worker processes (use: 2-4 x CPU cores)
WORKERS=4

# Instance ID for cluster coordination (auto-generated if not set)
# INSTANCE_ID=api-1

# =============================================================================
# NAT Traversal (P2P Connectivity)
# =============================================================================
# Enable STUN/TURN NAT traversal for P2P connectivity behind NAT/firewalls
NATLANGCHAIN_NAT_ENABLED=true

# STUN servers for NAT type detection and public IP discovery
# Comma-separated list of STUN server URIs (stun:host:port or host:port)
# Default: Google's public STUN servers
NATLANGCHAIN_STUN_SERVERS=stun.l.google.com:19302,stun1.l.google.com:19302

# TURN relay servers for connectivity when direct connection fails
# Comma-separated list of TURN URIs (turn:host:port?transport=udp)
# Only needed for symmetric NAT environments
# NATLANGCHAIN_TURN_SERVERS=turn:turn.example.com:3478?transport=udp

# TURN server authentication credentials
# Required if TURN servers are configured
NATLANGCHAIN_TURN_USERNAME=
NATLANGCHAIN_TURN_PASSWORD=

# Enable TURN relay fallback (default: true)
# Set to false to disable relay connections (direct-only mode)
NATLANGCHAIN_NAT_RELAY_ENABLED=true

# =============================================================================
# P2P Network
# =============================================================================
# Bootstrap peers for initial network connection (comma-separated endpoints)
# NATLANGCHAIN_BOOTSTRAP_PEERS=http://peer1.example.com:5000,http://peer2.example.com:5000

# Node ID (auto-generated if not set)
# NATLANGCHAIN_NODE_ID=node_abc123

# This node's public endpoint (auto-detected via STUN if not set)
# NATLANGCHAIN_ENDPOINT=http://your-public-ip:5000

# =============================================================================
# Block Compression (Bandwidth Optimization)
# =============================================================================
# Enable gzip compression for block transmission (recommended)
# Natural language prose compresses exceptionally well (typically 70-90% reduction)
NATLANGCHAIN_COMPRESSION_ENABLED=true

# Compression level (1-9): 1=fastest, 9=best compression, 6=balanced (default)
NATLANGCHAIN_COMPRESSION_LEVEL=6

# Minimum payload size to compress in bytes (smaller payloads skip compression)
NATLANGCHAIN_COMPRESSION_MIN_SIZE=512

# =============================================================================
# Adaptive Query Cache (Congestion Management)
# =============================================================================
# Enable congestion-aware query caching for mediator node queries
# Automatically increases cache TTLs during high load to reduce computation
NATLANGCHAIN_QUERY_CACHE_ENABLED=true

# Maximum number of cached query results
NATLANGCHAIN_QUERY_CACHE_MAX_SIZE=5000

# Congestion thresholds based on pending queue depth
# Below LOW: Light load, short cache TTLs for fresh data
# Above HIGH: Heavy load, longer cache TTLs to reduce computation
NATLANGCHAIN_CONGESTION_THRESHOLD_LOW=50
NATLANGCHAIN_CONGESTION_THRESHOLD_HIGH=200
